# 快速开始

<cite>
**本文档中引用的文件**
- [start_playwright.bat](file://start_playwright.bat)
- [start_playwright.sh](file://start_playwright.sh)
- [bilibili_cover_crawler_playwright.py](file://bilibili_cover_crawler_playwright.py)
- [requirements.txt](file://requirements.txt)
- [config.py](file://config.py)
</cite>

## 目录
1. [简介](#简介)
2. [运行启动脚本](#运行启动脚本)
3. [交互式操作流程](#交互式操作流程)
4. [完整示例流程](#完整示例流程)
5. [技术说明](#技术说明)
6. [环境准备](#环境准备)

## 简介

本指南旨在帮助新手用户快速上手运行本项目，通过简单的双击操作即可自动完成环境初始化并进入交互式抓取流程。项目利用Playwright浏览器自动化技术，从哔哩哔哩用户空间页面稳定获取视频封面与视频信息。

该方案无需修改任何代码，只需运行对应系统的启动脚本，程序将自动处理依赖安装、浏览器配置和任务执行，极大简化了使用流程。

## 运行启动脚本

### Windows系统

在Windows系统中，只需双击 `start_playwright.bat` 文件即可启动程序。

该批处理脚本会自动执行以下操作：
1. 检查 `python10` 命令是否存在
2. 若未安装依赖，则自动安装 `requirements.txt` 中列出的所有Python包
3. 自动安装Playwright所需的Chromium浏览器
4. 调用主程序 `bilibili_cover_crawler_playwright.py`

```batch
@echo off
chcp 65001 >nul
echo 🎭 哔哩哔哩封面爬虫 - Playwright版本启动器
...
```

**Section sources**
- [start_playwright.bat](file://start_playwright.bat#L1-L51)

### Linux系统

在Linux系统中，需先赋予脚本执行权限，然后运行 `start_playwright.sh`。

```bash
# 添加执行权限
chmod +x start_playwright.sh

# 运行脚本
./start_playwright.sh
```

该Shell脚本功能与Windows版本一致，会检查Python环境、安装缺失的依赖包和Playwright浏览器，最后启动主程序。

```bash
#!/bin/bash

echo "🎭 哔哩哔哩封面爬虫 - Playwright版本启动器"
...
```

**Section sources**
- [start_playwright.sh](file://start_playwright.sh#L1-L42)

## 交互式操作流程

运行启动脚本后，程序将进入交互式操作流程，具体步骤如下：

1. **环境检查与初始化**
   - 脚本首先检查Python环境和Playwright依赖
   - 若缺失依赖，将自动执行 `pip install -r requirements.txt`
   - 自动运行 `playwright install chromium` 安装浏览器
   - 显示启动信息和功能说明

2. **输入目标用户UID**
   - 程序提示用户输入要爬取的用户UID
   - 支持输入纯数字UID（如 `137429365`）
   - 输入 `q` 可退出程序

3. **确认操作**
   - 显示即将执行的操作模式
   - 提示用户确认是否继续

4. **自动执行任务**
   - 程序自动访问用户空间页面
   - 通过滚动和分页点击加载所有视频
   - 提取每个视频的封面图和相关信息
   - 使用tqdm显示实时进度条

**Section sources**
- [bilibili_cover_crawler_playwright.py](file://bilibili_cover_crawler_playwright.py#L2150-L2312)

## 完整示例流程

以下是一个完整的操作示例：

```
🎭 哔哩哔哩封面爬虫 - Playwright版本启动器
================================================

✅ 环境检查完成，启动爬虫程序...
🌐 此版本直接从用户空间页面获取视频信息，更加稳定！
🎯 支持滚动加载，可获取用户所有视频封面！
🎨 优先使用 bili-cover-card__thumbnail 获取封面！

🎭 哔哩哔哩视频爬虫 (Playwright版本 - 支持封面和视频下载)
=================================================================

🌟 功能特色:
- 🖼️ 封面下载 - 批量下载用户所有视频封面
- 📺 视频下载 - 支持下载用户所有视频或单个BV号
...

🎯 请输入要爬取的用户UID (或者输入 'q' 退出): 137429365

📋 操作模式:
  - 用户UID: 137429365
  - 下载封面: 是
  - 下载视频: 否

🚀 即将爬取用户 137429365 的封面，继续吗? (y/N): y

📺 开始从用户空间页面获取视频列表...
🌐 访问用户视频页面: https://space.bilibili.com/137429365/upload/video
🚀 初始化Playwright浏览器...
✅ 浏览器初始化完成
🌡️ 预热等待 3 秒...
预热中: 100%|████████████████████| 3/3 [00:03<00:00,  1.00s/ s]

🔄 开始收集视频信息，支持分页和滚动加载...
📄 处理第 1 页...
📺 第 1 页获取到 30 个新视频，总计 30 个
🔍 检查是否有下一页...
👆 点击下一页按钮...
✅ 成功跳转到下一页
📄 处理第 2 页...
📺 第 2 页获取到 30 个新视频，总计 60 个
...

🖼️ 开始下载封面...
下载封面: 100%|███████████████████| 65/65 [01:23<00:00,  1.23s/ s]

🎉 任务完成！
```

在整个过程中，tqdm进度条会实时显示视频收集和封面下载的进度，让用户清晰了解任务执行状态。

**Section sources**
- [bilibili_cover_crawler_playwright.py](file://bilibili_cover_crawler_playwright.py#L2150-L2312)

## 技术说明

### 脚本调用机制

启动脚本通过以下方式调用Python主程序：

```batch
if "%~1"=="" (
    python10 bilibili_cover_crawler_playwright.py
) else (
    python10 bilibili_cover_crawler_playwright.py %1
)
```

```bash
if [ $# -eq 0 ]; then
    python10 bilibili_cover_crawler_playwright.py
else
    python10 bilibili_cover_crawler_playwright.py $1
fi
```

脚本会将用户输入的UID作为命令行参数传递给主程序，实现自动化操作。

### Playwright浏览器自动化

本项目核心依赖Playwright实现浏览器自动化，具有以下优势：
- 模拟真实浏览器环境，降低被反爬虫系统检测的风险
- 支持JavaScript动态内容加载
- 自动处理页面滚动和分页点击
- 内置反检测机制（隐藏webdriver属性等）

```python
self.browser = await self.playwright.chromium.launch(
    headless=config.PLAYWRIGHT_CONFIG['headless'],
    slow_mo=config.PLAYWRIGHT_CONFIG['slow_mo'],
    args=config.BROWSER_ARGS
)
```

**Section sources**
- [bilibili_cover_crawler_playwright.py](file://bilibili_cover_crawler_playwright.py#L493-L811)
- [config.py](file://config.py#L1-L400)

## 环境准备

### 前置要求

- **Python环境**：确保已安装Python 3.10或更高版本，并添加到系统PATH
- **项目文件**：确保项目目录包含所有必要文件，特别是 `requirements.txt`

### 首次运行注意事项

首次运行时，脚本将自动执行以下操作：
1. 安装Python依赖包（从 `requirements.txt`）
2. 下载并安装Chromium浏览器（约100-200MB）
3. 可能需要较长时间（5-15分钟），请耐心等待

```txt
# 核心爬虫依赖
requests==2.31.0
beautifulsoup4==4.12.2
lxml==4.9.3
Pillow==10.0.1
tqdm==4.66.1

# Playwright浏览器自动化
playwright==1.40.0
```

若网络环境较差，可手动执行以下命令加速安装：
```bash
# 使用国内镜像源安装依赖
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple

# 安装Playwright浏览器
playwright install chromium
```

**Section sources**
- [requirements.txt](file://requirements.txt#L1-L25)
- [start_playwright.bat](file://start_playwright.bat#L1-L51)
- [start_playwright.sh](file://start_playwright.sh#L1-L42)